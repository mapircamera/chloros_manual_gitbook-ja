# 処理の開始

画像のインポート、キャリブレーションターゲットのマーク付け、プロジェクト設定の構成が完了したら、処理を開始する準備が整いました。このページでは、Chloros処理パイプラインの開始手順をガイドします。

## 事前処理チェックリスト

[開始]ボタンをクリックする前に、以下の項目がすべて整っていることを確認してください：

* [ ] **ファイルがインポート済み** - 全ての画像がファイルブラウザに表示されている
* [ ] **ターゲット画像がマーク済み** - キャリブレーション画像のターゲット列にチェックが入っている
* [ ] **カメラモデル検出済み** - カメラモデル列に正しいカメラが表示されている
* [ ] **設定構成済み** - プロジェクト設定を確認・調整済み
* [ ] **インデックス選択済み** - 必要なマルチスペクトルインデックスを追加済み（必要な場合）
* [ ] **出力形式選択済み** - ワークフローに適した出力形式を設定済み

{% hint style=&quot;info&quot; %}
**ヒント**: 処理前にファイルブラウザで数枚の画像をクリックし、正しく読み込まれたことを確認してください。
{% endhint %}

***

## 処理の開始

### 開始ボタンの位置

開始/再生ボタンはChlorosのヘッダー上部バーにあります：

* 位置：ウィンドウ上部中央
* アイコン：**再生/開始ボタン** <img src="../.gitbook/assets/image (2) (1).png" alt="" data-size="line">
* 状態: 処理準備完了時、ボタンは有効（明るい）状態

### クリックして開始

1. 上部ヘッダーの**再生/開始ボタン**をクリック
2. 処理が即時開始
3. 処理中はボタンが無効（グレー表示）に
4. 進行状況バーが更新され、処理状態を表示

{% hint style=&quot;success&quot; %}
**処理開始**: クリック後、Chlorosが自動的に全処理ステップを実行 - ターゲット検出、デベイヤー処理、キャリブレーション、インデックス計算、エクスポート。
{% endhint %}

***

## 処理モードの理解

Chlorosは、ライセンスに応じて2つの異なる処理モードで動作します：

### 無料モード（順次処理）

**全ユーザーが利用可能**

**動作原理:**

* 画像を1枚ずつ順次処理
* シングルスレッド動作
* メモリ使用量が少ない

**進行状況バーは2段階を表示:**

1.**ターゲット検出** - キャリブレーションターゲットのスキャン
2. **処理** - キャリブレーションの適用と画像のエクスポート**処理時間:**

* Chloros+ 並列モードより大幅に遅い
* 中小規模データセット（200枚未満）に適する

### Chloros+ モード（並列処理）

**Chloros+ ライセンスが必要**

**動作原理：**

* 複数画像を同時に処理
* マルチスレッド動作（最大16の並列ワーカー）
* 複数CPUコアを活用
* NVIDIAグラフィックカードによるGPU（CUDA）アクセラレーション（オプション）

**進行状況バーは4段階を表示：**

1.**検出** - キャリブレーションターゲットの発見
2. **解析** - 画像メタデータの検証とパイプラインの準備
3. **キャリブレーション** - 補正とキャリブレーションを適用
4. **エクスポート** - 処理済み画像とインデックスを保存**プログレスバー操作方法:*** **マウスをホバー** すると詳細な4段階のドロップダウンパネルが表示
* **クリック** でドロップダウンパネルを固定
* **再度クリック** で固定解除＆パネル非表示**処理時間:**

* フリーモードより大幅に高速
* CPUコア数に応じてスケーリング
* GPUアクセラレーションでさらに高速化

{% hint style=&quot;info&quot; %}
**Chloros+ 速度**: 大規模データセットでは、並列処理により順次モードより5～10倍高速化。フリーモードで2時間かかる500画像プロジェクトが、Chloros+では15～20分で完了可能。
{% endhint %}

***

## 処理中の動作

### ステージ1: ターゲット検出

**Chloros の動作:**

* マークされたターゲット画像（マークなしの場合は全画像）をスキャン
* 各ターゲット内の4つのキャリブレーションパネルを識別
* ターゲットパネルから反射率値を抽出
* キャリブレーションスケジューリング用にターゲットのタイムスタンプを記録

**所要時間:** 1～30秒（マーク付きターゲットの場合）、5～30分以上（マークなしの場合）

### ステージ2: デベイヤー処理（RAW変換）

**Chlorosの処理内容:**

* RAWベイヤーパターンデータを完全なRGB画像に変換
* 高品質デモザイクアルゴリズムを適用
* 最大画質と細部を保持

**所要時間:** 画像数とCPU速度により変動

### ステージ3: キャリブレーション

**Chlorosの処理内容:*** **ヴィネット補正**: レンズ周辺部の暗化を除去
* **反射率キャリブレーション**: ターゲット反射率値を用いて正規化
* 全バンド/チャンネルに補正を適用
* タイムスタンプに基づき各画像に適切なキャリブレーションターゲットを使用

**所要時間:** 処理時間の大部分を占める

### ステージ4: 指数計算

**Chlorosの処理内容:**

* 設定されたマルチスペクトル指数（NDVI、NDREなど）を計算
* 較正済み画像にバンド演算を適用
* 選択された各インデックス用のインデックス画像を生成

**所要時間:** 画像ごとに数秒

### ステージ5: エクスポート

**Chlorosの処理内容:**

* 較正済み画像を選択した形式で保存
* 設定されたLUTカラーでインデックス画像をエクスポート
* カメラモデル別サブフォルダへファイルを書き込み
* オリジナルファイル名をサフィックス付きで保持

**所要時間:** エクスポート形式とファイルサイズにより変動***

## 処理動作

### 自動処理パイプライン

開始後、パイプライン全体が自動実行:

* ユーザー操作不要
* 設定済み全ステップを順次実行
* 進行状況をリアルタイムで表示

### 処理中のコンピューター使用状況

**フリーモード:**

* CPU使用率が比較的低い（シングルスレッド）
* 他のタスクでコンピューターが応答可能
* Chlorosを最小化して他のアプリケーションで作業可能

**Chloros+ 並列モード:**

* 高いCPU使用率（マルチスレッド、最大16コア）
* GPUアクセラレーション時：高いGPU使用率
* 処理中はコンピュータの応答性が低下する可能性あり
* 他のCPU負荷の高いタスクの起動は避ける

{% hint style=&quot;warning&quot; %}
**パフォーマンスのヒント**: 最適なChloros+パフォーマンスを得るには、他のアプリケーションを閉じてChlorosがシステムリソースを完全に使用できるようにしてください。
{% endhint %}

### 処理の一時停止は不可

**重要な制限事項:**

* 処理開始後は一時停止できません
* 処理はキャンセル可能ですが、進行状況は失われます
* 部分的な結果は保存されません
* キャンセルした場合、最初から再実行する必要があります

**計画のヒント:** 非常に大規模なプロジェクトでは、バッチ処理やCLIの使用による制御強化をご検討ください。***

## プロセッシングの監視

プロセッシング実行中は以下が可能です：

* **進捗バーの確認** - 全体の完了率を表示
* **現在の段階の確認** - 検出、分析、キャリブレーション、またはエクスポート
* **ログタブの確認** - 詳細な処理メッセージと警告を表示
* **完了済み画像のプレビュー** - 一部のエクスポートファイルは処理中に表示される場合があります

監視の詳細については、[プロセッシングの監視](monitoring-the-processing.md)を参照してください。

***

## プロセッシングの中止

プロセッシングを停止する必要がある場合：

### 中止方法

1. **停止/キャンセルボタン**（処理中は開始ボタンと入れ替わります）を探す
2. 停止ボタンをクリック
3. 処理が即時停止
4. 途中結果は破棄される

### キャンセルすべき場合

**正当なキャンセル理由:**

* 誤った設定を使用したことに気付いた場合
* 対象画像のマーク付けを忘れた場合
* 誤った画像をインポートした場合
* システムの動作が遅すぎる、または応答しない場合

**キャンセル後:**

* 問題点を確認・修正する
* 必要に応じて設定を調整する
* 処理を最初から再開する
* 最適な状態にするには、Chlorosを完全に終了し再起動する

{% hint style=&quot;warning&quot; %}
**部分的な結果は保存されません**：キャンセルするとすべての進行状況が破棄されます。 Chloros は部分処理済み画像を保存しません。
{% endhint %}

***

## 処理時間の見積もり

実際の処理時間は以下により大きく変動します:

* 画像枚数
* 画像解像度
* RAW 対 JPG 入力形式
* 処理モード （無料版 vs Chloros+）
* CPU速度とコア数
* GPU利用可否（Chloros+のみ）
* 計算するインデックス数
* エクスポート形式の複雑さ

### おおよその見積もり（Chloros+、12MP画像、最新CPU）

| 画像枚数 | 無料モード | Chloros+ (CPU) | Chloros+ (GPU) |
| ----------- | --------- | -------------- | -------------- |
| 50 画像   | 15-20 分 | 5-8 分        | 3-5 分        |
| 100 画像  | 30-40 分 | 10-15 分      | 5-8 分        |
| 200 画像  | 1-1.5 時間 | 20-30 分      | 10-15 分      |
| 500枚  | 2-3時間   | 45-60分      | 20-30分      |
| 1000枚 | 4-6時間   | 1.5-2時間      | 40-60分      |

{% hint style=&quot;info&quot; %}
**初回実行**: キャッシュとプロファイルを構築するため、初回処理には時間がかかる場合があります。Chloros 類似データセットのその後の処理は高速化されます。
{% endhint %}

***

## 起動時の一般的な問題

### 起動ボタンが無効化（グレー表示）

**考えられる原因:**

* 画像がインポートされていない
* バックエンドが完全に起動していない
* 以前の処理がまだ実行中
* プロジェクトが完全に読み込まれていない

**解決策:**

1. バックエンドが完全に初期化されるまで待機（メインメニューアイコンを確認）
2. ファイルブラウザで画像がインポートされていることを確認
3. ボタンが無効なままの場合、Chlorosを再起動
4. デバッグログでエラーメッセージを確認

### 処理開始直後に失敗する

**考えられる原因:**

* プロジェクト内に有効な画像がない
* 画像ファイルが破損している
* ディスク容量が不足している
* メモリ（RAM）が不足している

**解決策:**

1. デバッグログを確認 <img src="../.gitbook/assets/icon_log.JPG" alt="" data-size="line"> でエラーメッセージを確認
2. 空きディスク容量を確認
3. より少数の画像で処理を試行
4. 画像が破損していないことを確認

### 「ターゲットが検出されません」警告

**考えられる原因:**

* ターゲット画像のマーク付け忘れ
* ターゲット画像に可視ターゲットが含まれていない
* ターゲット検出設定が厳しすぎる

**解決策:**

1. [ターゲット画像の選択](choosing-target-images.md) を確認
2. ターゲット列で適切な画像にマーク
3. マーク済み画像にターゲットが可視化されているか確認
4. 必要に応じてターゲット検出設定を調整

***

## 処理成功のためのヒント

### 開始前

1. **まず小規模なサブセットでテスト** - 設定確認のため10～20枚の画像を処理
2. **利用可能なディスク容量を確認** - データセットサイズの2～3倍の空き容量を確保
3. **不要なアプリケーションを閉じる** - システムリソースを解放
4. **ターゲット画像を検証** - マークしたターゲットをプレビューし品質を確認
5. **プロジェクトを保存** - 自動保存されますが、手動保存が推奨されます

### 処理中

1. **システムのスリープを回避** - 省電力モードを無効化
2. **Chlorosをフォアグラウンドに維持** - タスクバーに表示される状態を保つ
3. **進捗を随時確認** - 警告やエラーの有無をチェック
4. **他の重いアプリケーションを起動しない** - 特にChloros+並列モード使用時

### Chloros+ GPUアクセラレーション

NVIDIA GPUアクセラレーション使用時：

1. NVIDIAドライバを最新版に更新
2. GPUのVRAMが4GB以上あることを確認
3. GPU負荷の高いアプリケーション（ゲーム、動画編集）を終了
4. GPU温度を監視（十分な冷却を確保）

***

## 次に取るべき手順

処理が開始されたら：

1. **進捗を監視** - [処理の監視](monitoring-the-processing.md)を参照
2. **完了を待つ** - 処理は自動実行されます
3. **結果を確認する** - [処理の終了](finishing-the-processing.md)を参照

処理中の対応方法については、[処理の監視](monitoring-the-processing.md)を参照してください。
